@{
    Layout = null;
    var fileName = ViewData["FileName"] as string ?? "";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>@fileName - PDF Viewer</title>
    <link rel="stylesheet" href="~/css/pdf-viewer.css" asp-append-version="true" />
</head>
<body>
    <div id="loading" class="pdf-loading">
        <div>
            <div class="spinner"></div>
            <p>Loading PDF...</p>
        </div>
    </div>

    <iframe id="pdfFrame"
            class="pdf-frame"
            src="/js/pdfjs/web/viewer.html?file=/Pdf/Stream/@Uri.EscapeDataString(fileName)"
            style="display: none;"
            onload="hideLoading()"
            onerror="showError()">
    </iframe>

    <div id="error" style="display: none; padding: 20px; text-align: center; font-family: Arial, sans-serif;">
        <h3>Error Loading PDF</h3>
        <p>Unable to load the PDF viewer. Please check:</p>
        <ul style="text-align: left; display: inline-block;">
            <li>PDF.js is installed in /js/pdfjs/</li>
            <li>The PDF file exists</li>
            <li>Your browser supports PDF viewing</li>
        </ul>
        <button onclick="location.reload()">Retry</button>
    </div>

    <script>
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('pdfFrame').style.display = 'block';
        }

        function showError() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('pdfFrame').style.display = 'none';
            document.getElementById('error').style.display = 'block';
        }

        // Fallback: hide loading after 10 seconds
        setTimeout(function() {
            if (document.getElementById('loading').style.display !== 'none') {
                hideLoading();
            }
        }, 10000);
    </script>
</body>
</html>